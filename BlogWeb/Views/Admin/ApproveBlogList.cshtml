@using BlogWeb.DL.Models
@model IEnumerable<BlogWeb.DL.Models.Blog>
@{
    ViewData["Title"] = "Makale Onay";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h1>Makale Onayla</h1>


@{
    int OnaylamaSonuc = Convert.ToInt16(TempData["OnaylamaSonuc"]);
}

@if (OnaylamaSonuc == 1)
{
    <div class="alert alert-dismissible alert-success">
        <strong>Onaylama Başarılı!</strong> <p> Makale Başarılı Bir şekilde Onaylandı</p>
    </div>
}

<div class="table-responsive-lg">
    <table class="table table-hover">

        <thead>
            <tr>
                <th scope="col">Kapak Resmi</th>
                <th scope="col">Başlık</th>
                <th scope="col">Kategori</th>
                <th scope="col">Tarih</th>
                <th scope="col">Durum</th>
                <th scope="col">İşlem</th>
            </tr>
        </thead>
        @foreach (var item in Model)
        {

            <tbody>
                <tr class="table-secondary">
                    <th scope="row"><img class="card-img-top" style="max-height:100px; max-width:100px;" src="~/images/@item.ImageUrl"></th>
                    <td>@item.BlogTitle</td>

                    <td>
                        @{
                            Context c = new Context();
                            var result = c.Category.Where(x => x.CategoryId == @item.CategoryId).FirstOrDefault();
                        }
                        @result.CategoryName

                    </td>
                    <td>@item.Date.ToShortDateString()</td>
                    <td>
                        @if (item.Status == false)
                        {
                            <p> Onay Bekliyor</p>
                        }
                        else
                        {
                            <p> Onaylandı</p>
                        }
                    </td>
                    <td>
                        <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                            <a class="btn btn-info" href="~/Admin/BlogDetail/@item.BlogId">Detay</a> &nbsp;
                            <a class="btn btn-warning" onclick="onayla(@item.BlogId)">Onayla</a>

                        </div>
                    </td>
                </tr>
            </tbody>
        }
    </table>
</div>

<script>
    function deneme(id) {
        swal({
            title: "Emin misiniz?",
            text: "Makale bilgisini silmek için emin misiniz?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    window.location.replace('/Admin/BlogDelete/' + id),
                        swal("Poof! Makale Silindi!", {
                            icon: "success",
                        });
                }
            });
    }

    function onayla(id) {
        swal({
            title: "Emin misiniz?",
            text: "Makaleyi yayınını onaylamak için emin misiniz?",
            icon: "info",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    window.location.replace('/Admin/ApproveBlog/' + id),
                        swal("Makale Onaylandı!", {
                            icon: "success",
                        });
                }
            });
    }


</script>

<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>